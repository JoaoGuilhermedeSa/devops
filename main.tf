<same as in canvas, omitted here for brevity>